\hypertarget{gestor__apuestas_8h}{}\section{Referencia del Archivo gestor\+\_\+apuestas.\+h}
\label{gestor__apuestas_8h}\index{gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}}


En este archivo .h se declaran todas las funciones que tienen que ver con gestionar las apuestas llegadas desde los procesos apostador. Incluyen el \hyperlink{gestor__apuestas_8h_a56c90ca40de5974953135376d5236ccf}{proceso\+\_\+gestor\+\_\+apuestas()}, que es el más general y que basicamente añade las zonas de memoria compartida y genera hilos ventanilla para que gestionen las apuestas, el \hyperlink{gestor__apuestas_8h_af1bfe5100095244e285190aa899c2a32}{hilo\+\_\+ventanilla()}, que recibe mensajes de apuestas y realiza las operaciones neccesarias para almacenar esa informacion y para actualizar las cotizacciones de los caballos, y la funcion guardar\+\_\+apuesta, que almacena en un archivo .txt un historial con todas las apuestas realizadas para que luego se imprima esa informacion mediante el proceso monitor al finalizar la carrera.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
Dependencia gráfica adjunta para gestor\+\_\+apuestas.\+h\+:
% FIG 0
Gráfico de los archivos que directa o indirectamente incluyen a este archivo\+:
% FIG 1
\subsection*{Funciones}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{gestor__apuestas_8h_a56c90ca40de5974953135376d5236ccf}{proceso\+\_\+gestor\+\_\+apuestas} (int n\+\_\+cab, int n\+\_\+vent, int n\+\_\+apost, int msgid)
\begin{DoxyCompactList}\small\item\em proceso que se encarga de tratar las apuestas recibidas. Para ello crea n\+\_\+vent hilos que reciben mensajes desde apostador y tratan con dicha informacion, almacenando en un archivo historial cada una de las apuestas con toda la informacion relevante, actualizando la cotizacion de los caballos y almacenando en una matriz apostador cuanto ganara cada uno de los apostadores si gana cada uno de los caballos. Una vez comenzada la carrera deja de recibir apuestas y envia a monitor la informacion que ha ido almacenando para que, una vez finalizada la carrera, la muestre por pantalla. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{gestor__apuestas_8h_af1bfe5100095244e285190aa899c2a32}{hilo\+\_\+ventanilla} (void $\ast$arg)
\item 
int \hyperlink{gestor__apuestas_8h_a8698c66708ec74021f102a4c0e9049df}{guardar\+\_\+apuesta} (int apostador, int ventanilla, int caballo, double cotizacion\+\_\+caballo, double apuesta)
\begin{DoxyCompactList}\small\item\em esta funcion se encarga de almacenar en un archivo historial cada una de las apuestas realizadas en los momentos previos a la ejecucion de la carrera. Esta informacion sera usada al final por el monitor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{gestor__apuestas_8h_a5d57de20ecaa222fcf3ef6df9deb9688}\label{gestor__apuestas_8h_a5d57de20ecaa222fcf3ef6df9deb9688}} 
void {\bfseries manejador\+\_\+gestor\+\_\+terminar} (int sig)
\end{DoxyCompactItemize}


\subsection{Descripción detallada}
En este archivo .h se declaran todas las funciones que tienen que ver con gestionar las apuestas llegadas desde los procesos apostador. Incluyen el \hyperlink{gestor__apuestas_8h_a56c90ca40de5974953135376d5236ccf}{proceso\+\_\+gestor\+\_\+apuestas()}, que es el más general y que basicamente añade las zonas de memoria compartida y genera hilos ventanilla para que gestionen las apuestas, el \hyperlink{gestor__apuestas_8h_af1bfe5100095244e285190aa899c2a32}{hilo\+\_\+ventanilla()}, que recibe mensajes de apuestas y realiza las operaciones neccesarias para almacenar esa informacion y para actualizar las cotizacciones de los caballos, y la funcion guardar\+\_\+apuesta, que almacena en un archivo .txt un historial con todas las apuestas realizadas para que luego se imprima esa informacion mediante el proceso monitor al finalizar la carrera. 

\begin{DoxyAuthor}{Autor}
Miguel Baquedano \href{mailto:miguel.baquedano@estudiante.uam.es}{\tt miguel.\+baquedano@estudiante.\+uam.\+es} 

Sergio Cordero \href{mailto:sergio.cordero@estudiante.uam.es}{\tt sergio.\+cordero@estudiante.\+uam.\+es} 
\end{DoxyAuthor}
\begin{DoxyVersion}{Versión}
1.\+0 
\end{DoxyVersion}
\begin{DoxyDate}{Fecha}
05-\/05-\/2018 
\end{DoxyDate}


\subsection{Documentación de las funciones}
\mbox{\Hypertarget{gestor__apuestas_8h_a8698c66708ec74021f102a4c0e9049df}\label{gestor__apuestas_8h_a8698c66708ec74021f102a4c0e9049df}} 
\index{gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}!guardar\+\_\+apuesta@{guardar\+\_\+apuesta}}
\index{guardar\+\_\+apuesta@{guardar\+\_\+apuesta}!gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}}
\subsubsection{\texorpdfstring{guardar\+\_\+apuesta()}{guardar\_apuesta()}}
{\footnotesize\ttfamily int guardar\+\_\+apuesta (\begin{DoxyParamCaption}\item[{int}]{apostador,  }\item[{int}]{ventanilla,  }\item[{int}]{caballo,  }\item[{double}]{cotizacion\+\_\+caballo,  }\item[{double}]{apuesta }\end{DoxyParamCaption})}



esta funcion se encarga de almacenar en un archivo historial cada una de las apuestas realizadas en los momentos previos a la ejecucion de la carrera. Esta informacion sera usada al final por el monitor. 


\begin{DoxyParams}{Parámetros}
{\em apostador} & el apostador que ha realizado dicha apuesta \\
\hline
{\em ventanilla} & la ventanilla que ha procesado la apuesta \\
\hline
{\em caballo} & caballo al que se ha apostado \\
\hline
{\em cotizacion\+\_\+caballo} & la cotizacion del caballo en el momento de la apuesta \\
\hline
{\em apuesta} & cantidad de dinero apostado \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
1 o -\/1 en funcion de si ejecuta correcta o incorrectamente 
\end{DoxyReturn}
\mbox{\Hypertarget{gestor__apuestas_8h_af1bfe5100095244e285190aa899c2a32}\label{gestor__apuestas_8h_af1bfe5100095244e285190aa899c2a32}} 
\index{gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}!hilo\+\_\+ventanilla@{hilo\+\_\+ventanilla}}
\index{hilo\+\_\+ventanilla@{hilo\+\_\+ventanilla}!gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}}
\subsubsection{\texorpdfstring{hilo\+\_\+ventanilla()}{hilo\_ventanilla()}}
{\footnotesize\ttfamily void$\ast$ hilo\+\_\+ventanilla (\begin{DoxyParamCaption}\item[{void $\ast$}]{arg }\end{DoxyParamCaption})}


\begin{DoxyParams}{Parámetros}
{\em arg} & puntero a void que contiene un puntero a una estructura argumentos. Esta estructura guarda todos los parametros necesarios para la correcta ejecucion del hilo. Ver \hyperlink{estructuras_8h}{estructuras.\+h} para mas informacion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
es vacio puesto que aunque sea necesario indicar void $\ast$ (por ser funcion para hilo) no queremos devolver nada 
\end{DoxyReturn}
\mbox{\Hypertarget{gestor__apuestas_8h_a56c90ca40de5974953135376d5236ccf}\label{gestor__apuestas_8h_a56c90ca40de5974953135376d5236ccf}} 
\index{gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}!proceso\+\_\+gestor\+\_\+apuestas@{proceso\+\_\+gestor\+\_\+apuestas}}
\index{proceso\+\_\+gestor\+\_\+apuestas@{proceso\+\_\+gestor\+\_\+apuestas}!gestor\+\_\+apuestas.\+h@{gestor\+\_\+apuestas.\+h}}
\subsubsection{\texorpdfstring{proceso\+\_\+gestor\+\_\+apuestas()}{proceso\_gestor\_apuestas()}}
{\footnotesize\ttfamily void proceso\+\_\+gestor\+\_\+apuestas (\begin{DoxyParamCaption}\item[{int}]{n\+\_\+cab,  }\item[{int}]{n\+\_\+vent,  }\item[{int}]{n\+\_\+apost,  }\item[{int}]{msgid }\end{DoxyParamCaption})}



proceso que se encarga de tratar las apuestas recibidas. Para ello crea n\+\_\+vent hilos que reciben mensajes desde apostador y tratan con dicha informacion, almacenando en un archivo historial cada una de las apuestas con toda la informacion relevante, actualizando la cotizacion de los caballos y almacenando en una matriz apostador cuanto ganara cada uno de los apostadores si gana cada uno de los caballos. Una vez comenzada la carrera deja de recibir apuestas y envia a monitor la informacion que ha ido almacenando para que, una vez finalizada la carrera, la muestre por pantalla. 


\begin{DoxyParams}{Parámetros}
{\em n\+\_\+cab} & entero que representa el numero de caballos que disputan la carrera. \\
\hline
{\em n\+\_\+vent} & entero que representa el numero de ventanillas que existen para atender a las apuestas generadas por los procesos apostador \\
\hline
{\em n\+\_\+apost} & entero que representa el numero de apostadores existentes para esta carrera \\
\hline
{\em msgid} & entero que identifica la cola de mensajes usada por los hilos ventanilla \\
\hline
\end{DoxyParams}
